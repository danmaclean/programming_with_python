<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Beginning Programming with Python</title>
  <meta name="description" content="A guide to beginning programming with Python">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Beginning Programming with Python" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guide to beginning programming with Python" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Beginning Programming with Python" />
  
  <meta name="twitter:description" content="A guide to beginning programming with Python" />
  

<meta name="author" content="Dan MacLean">


<meta name="date" content="2019-01-11">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="user-functions.html">
<link rel="next" href="putting-code-into-scripts.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Beginning Programming with Python</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installing-python-3-with-anaconda"><i class="fa fa-check"></i><b>1.1</b> Installing Python 3 with Anaconda</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#note-for-macos-users"><i class="fa fa-check"></i><b>1.1.1</b> Note for macOS users</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#note-for-windows-users"><i class="fa fa-check"></i><b>1.1.2</b> Note for Windows users</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#note-for-linux-users"><i class="fa fa-check"></i><b>1.1.3</b> Note for Linux Users</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#starting-a-jupyter-notebook"><i class="fa fa-check"></i><b>1.2</b> Starting a Jupyter Notebook</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#macos"><i class="fa fa-check"></i><b>1.2.1</b> macOS</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#windows"><i class="fa fa-check"></i><b>1.2.2</b> Windows</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#linux"><i class="fa fa-check"></i><b>1.2.3</b> Linux</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-python-packages-with-conda"><i class="fa fa-check"></i><b>1.3</b> Installing Python Packages with <code>conda</code></a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#installing-a-text-editor"><i class="fa fa-check"></i><b>1.4</b> Installing a Text Editor</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Working with Data</a><ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#using-variables-as-names-for-data"><i class="fa fa-check"></i><b>3.1</b> Using variables as names for data</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#python-has-three-main-types-of-function"><i class="fa fa-check"></i><b>3.2</b> Python has three main types of function</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data.html"><a href="data.html#built-in-functions-and-operators"><i class="fa fa-check"></i><b>3.2.1</b> Built-In Functions and Operators</a></li>
<li class="chapter" data-level="3.2.2" data-path="data.html"><a href="data.html#functions-from-packages"><i class="fa fa-check"></i><b>3.2.2</b> Functions from packages</a></li>
<li class="chapter" data-level="3.2.3" data-path="data.html"><a href="data.html#object-methods"><i class="fa fa-check"></i><b>3.2.3</b> Object Methods</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#objects-and-types-in-python"><i class="fa fa-check"></i><b>3.3</b> Objects and types in Python</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data.html"><a href="data.html#string-objects"><i class="fa fa-check"></i><b>3.3.1</b> String Objects</a></li>
<li class="chapter" data-level="3.3.2" data-path="data.html"><a href="data.html#number-objects"><i class="fa fa-check"></i><b>3.3.2</b> Number Objects</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#quiz"><i class="fa fa-check"></i><b>3.4</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>4</b> Data Structures</a><ul>
<li class="chapter" data-level="4.1" data-path="data-structures.html"><a href="data-structures.html#lists-are-ordered-linear-collections-of-items"><i class="fa fa-check"></i><b>4.1</b> Lists are ordered linear collections of items</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-structures.html"><a href="data-structures.html#list-use"><i class="fa fa-check"></i><b>4.1.1</b> List use</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-structures.html"><a href="data-structures.html#list-methods"><i class="fa fa-check"></i><b>4.1.2</b> List methods</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-structures.html"><a href="data-structures.html#dictionaries-are-unordered-collections"><i class="fa fa-check"></i><b>4.2</b> Dictionaries are unordered collections</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-structures.html"><a href="data-structures.html#dictionary-methods"><i class="fa fa-check"></i><b>4.2.1</b> Dictionary Methods</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-structures.html"><a href="data-structures.html#quiz-1"><i class="fa fa-check"></i><b>4.3</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="making-choices-and-controlling-program-flow.html"><a href="making-choices-and-controlling-program-flow.html"><i class="fa fa-check"></i><b>5</b> Making Choices and Controlling Program Flow</a><ul>
<li class="chapter" data-level="5.1" data-path="making-choices-and-controlling-program-flow.html"><a href="making-choices-and-controlling-program-flow.html#conditionals-check-values-and-adjust-which-code-is-run"><i class="fa fa-check"></i><b>5.1</b> Conditionals check values and adjust which code is run</a></li>
<li class="chapter" data-level="5.2" data-path="making-choices-and-controlling-program-flow.html"><a href="making-choices-and-controlling-program-flow.html#indentation-in-python-is-pretty-important"><i class="fa fa-check"></i><b>5.2</b> Indentation in Python is Pretty Important</a></li>
<li class="chapter" data-level="5.3" data-path="making-choices-and-controlling-program-flow.html"><a href="making-choices-and-controlling-program-flow.html#more-ifs"><i class="fa fa-check"></i><b>5.3</b> More <code>if</code>s</a><ul>
<li class="chapter" data-level="5.3.1" data-path="making-choices-and-controlling-program-flow.html"><a href="making-choices-and-controlling-program-flow.html#testing-equality"><i class="fa fa-check"></i><b>5.3.1</b> Testing equality</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="making-choices-and-controlling-program-flow.html"><a href="making-choices-and-controlling-program-flow.html#logical-operators-in-tests"><i class="fa fa-check"></i><b>5.4</b> Logical operators in tests</a><ul>
<li class="chapter" data-level="5.4.1" data-path="making-choices-and-controlling-program-flow.html"><a href="making-choices-and-controlling-program-flow.html#what-is-true-and-what-is-false"><i class="fa fa-check"></i><b>5.4.1</b> What is True and what is False</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="making-choices-and-controlling-program-flow.html"><a href="making-choices-and-controlling-program-flow.html#thats-not-not-what-i-meant"><i class="fa fa-check"></i><b>5.5</b> That’s not not what I meant</a></li>
<li class="chapter" data-level="5.6" data-path="making-choices-and-controlling-program-flow.html"><a href="making-choices-and-controlling-program-flow.html#quiz-2"><i class="fa fa-check"></i><b>5.6</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="repeating-actions-with-loops.html"><a href="repeating-actions-with-loops.html"><i class="fa fa-check"></i><b>6</b> Repeating actions with Loops</a><ul>
<li class="chapter" data-level="6.1" data-path="repeating-actions-with-loops.html"><a href="repeating-actions-with-loops.html#for-loops"><i class="fa fa-check"></i><b>6.1</b> For Loops</a><ul>
<li class="chapter" data-level="6.1.1" data-path="repeating-actions-with-loops.html"><a href="repeating-actions-with-loops.html#choosing-loop-variable-names"><i class="fa fa-check"></i><b>6.1.1</b> Choosing loop variable names</a></li>
<li class="chapter" data-level="6.1.2" data-path="repeating-actions-with-loops.html"><a href="repeating-actions-with-loops.html#loop-variable-lifespan"><i class="fa fa-check"></i><b>6.1.2</b> Loop variable lifespan</a></li>
<li class="chapter" data-level="6.1.3" data-path="repeating-actions-with-loops.html"><a href="repeating-actions-with-loops.html#looping-over-a-list"><i class="fa fa-check"></i><b>6.1.3</b> Looping over a list</a></li>
<li class="chapter" data-level="6.1.4" data-path="repeating-actions-with-loops.html"><a href="repeating-actions-with-loops.html#looping-over-a-range-of-numbers"><i class="fa fa-check"></i><b>6.1.4</b> Looping over a range of numbers</a></li>
<li class="chapter" data-level="6.1.5" data-path="repeating-actions-with-loops.html"><a href="repeating-actions-with-loops.html#looping-over-a-dictionary"><i class="fa fa-check"></i><b>6.1.5</b> Looping over a dictionary</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="repeating-actions-with-loops.html"><a href="repeating-actions-with-loops.html#while-loops"><i class="fa fa-check"></i><b>6.2</b> While Loops</a></li>
<li class="chapter" data-level="6.3" data-path="repeating-actions-with-loops.html"><a href="repeating-actions-with-loops.html#quiz-3"><i class="fa fa-check"></i><b>6.3</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="user-functions.html"><a href="user-functions.html"><i class="fa fa-check"></i><b>7</b> User Functions</a><ul>
<li class="chapter" data-level="7.1" data-path="user-functions.html"><a href="user-functions.html#building-your-own-function"><i class="fa fa-check"></i><b>7.1</b> Building your own function</a></li>
<li class="chapter" data-level="7.2" data-path="user-functions.html"><a href="user-functions.html#composing-functions"><i class="fa fa-check"></i><b>7.2</b> Composing functions</a></li>
<li class="chapter" data-level="7.3" data-path="user-functions.html"><a href="user-functions.html#variables-inside-and-outside-functions"><i class="fa fa-check"></i><b>7.3</b> Variables inside and outside Functions</a></li>
<li class="chapter" data-level="7.4" data-path="user-functions.html"><a href="user-functions.html#designing-programs-to-use-functions"><i class="fa fa-check"></i><b>7.4</b> Designing programs to use functions</a></li>
<li class="chapter" data-level="7.5" data-path="user-functions.html"><a href="user-functions.html#quiz-4"><i class="fa fa-check"></i><b>7.5</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="working-with-python-packages.html"><a href="working-with-python-packages.html"><i class="fa fa-check"></i><b>8</b> Working with Python Packages</a><ul>
<li class="chapter" data-level="8.1" data-path="working-with-python-packages.html"><a href="working-with-python-packages.html#using-and-installing-packages."><i class="fa fa-check"></i><b>8.1</b> Using and Installing Packages.</a></li>
<li class="chapter" data-level="8.2" data-path="working-with-python-packages.html"><a href="working-with-python-packages.html#the-pyvcf-package"><i class="fa fa-check"></i><b>8.2</b> The PyVCF Package</a><ul>
<li class="chapter" data-level="8.2.1" data-path="working-with-python-packages.html"><a href="working-with-python-packages.html#vcf-files---a-brief-introduction"><i class="fa fa-check"></i><b>8.2.1</b> VCF files - a brief introduction</a></li>
<li class="chapter" data-level="8.2.2" data-path="working-with-python-packages.html"><a href="working-with-python-packages.html#the-vcf.reader-object"><i class="fa fa-check"></i><b>8.2.2</b> The <code>vcf.Reader</code> object</a></li>
<li class="chapter" data-level="8.2.3" data-path="working-with-python-packages.html"><a href="working-with-python-packages.html#the-vcf.record-object"><i class="fa fa-check"></i><b>8.2.3</b> The <code>vcf.Record</code> object</a></li>
<li class="chapter" data-level="8.2.4" data-path="working-with-python-packages.html"><a href="working-with-python-packages.html#object-attributes"><i class="fa fa-check"></i><b>8.2.4</b> Object Attributes</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="working-with-python-packages.html"><a href="working-with-python-packages.html#quiz-5"><i class="fa fa-check"></i><b>8.3</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="putting-code-into-scripts.html"><a href="putting-code-into-scripts.html"><i class="fa fa-check"></i><b>9</b> Putting code into scripts</a><ul>
<li class="chapter" data-level="9.1" data-path="putting-code-into-scripts.html"><a href="putting-code-into-scripts.html#the-script-header"><i class="fa fa-check"></i><b>9.1</b> The script header</a></li>
<li class="chapter" data-level="9.2" data-path="putting-code-into-scripts.html"><a href="putting-code-into-scripts.html#the-filename-extension"><i class="fa fa-check"></i><b>9.2</b> The filename extension</a></li>
<li class="chapter" data-level="9.3" data-path="putting-code-into-scripts.html"><a href="putting-code-into-scripts.html#running-a-python-script-from-the-command-line"><i class="fa fa-check"></i><b>9.3</b> Running a python script from the command line</a></li>
<li class="chapter" data-level="9.4" data-path="putting-code-into-scripts.html"><a href="putting-code-into-scripts.html#getting-options-from-the-command-line"><i class="fa fa-check"></i><b>9.4</b> Getting Options from the Command Line</a></li>
<li class="chapter" data-level="9.5" data-path="putting-code-into-scripts.html"><a href="putting-code-into-scripts.html#quiz-6"><i class="fa fa-check"></i><b>9.5</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html"><i class="fa fa-check"></i><b>10</b> Putting It All Together</a><ul>
<li class="chapter" data-level="10.1" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#a-challenge-in-python"><i class="fa fa-check"></i><b>10.1</b> A Challenge in Python</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>11</b> Acknowledgements</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Beginning Programming with Python</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-python-packages" class="section level1">
<h1><span class="header-section-number">Section 8</span> Working with Python Packages</h1>
<ol style="list-style-type: decimal">
<li>Questions:</li>
</ol>
<ul>
<li>How can I use the wide range of code that other people have already written?</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Objectives:</li>
</ol>
<ul>
<li>Install and Import packages using package managers</li>
<li>Use PyVCF - a genomics related package</li>
<li>Examine objects from this package</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Keypoints:</li>
</ol>
<ul>
<li>Packages that come from external sources need to be installed</li>
<li>There are many, many packages</li>
<li>Packages provide methods and objects of varying types</li>
<li>Good package use relies on good package documentation</li>
</ul>
<p>Packages are an important part of the Python ‘ecosystem’ that let us use a wide variety of code written by other people. Good packages provide functions, objects and methods that make working in a particular problem domain a lot easier.</p>
<div id="using-and-installing-packages." class="section level2">
<h2><span class="header-section-number">8.1</span> Using and Installing Packages.</h2>
<p>We’ve already seen how to load in packages using the <code>import</code> statement. Here we load the builit-in <code>sys</code> package which has methods for working with the underlying system - the <code>platform</code> is the name of the operating system this code is running on.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="im">import</span> sys</a>
<a class="sourceLine" id="cb160-2" data-line-number="2"><span class="bu">print</span>( sys.platform )</a></code></pre></div>
<pre><code>## darwin</code></pre>
<p>Some packages, like <code>sys</code> come as standard when Python is installed, some come from external sources and must be installed individually. There are multiple methods of installing packages. Assuming you set up Python using Anaconda for this book then you can use <code>conda</code> itself. Another more general way of installing packages is from PyPI, the Python Package Index.</p>
<p>None of these are done from within Python itself, they must be done from the regular command-line. The general form is:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb162-1" data-line-number="1"><span class="ex">conda</span> install package_name</a>
<a class="sourceLine" id="cb162-2" data-line-number="2"><span class="ex">pip</span> install package_name</a></code></pre></div>
</div>
<div id="the-pyvcf-package" class="section level2">
<h2><span class="header-section-number">8.2</span> The PyVCF Package</h2>
<p>VCF files (variant call format) are files that describe SNPs and small indels in alignments from high-throughput sequencing data. The <code>PyVCF</code> package provides a lot of functionality for working with such files and the record they contain.</p>
<div id="vcf-files---a-brief-introduction" class="section level3">
<h3><span class="header-section-number">8.2.1</span> VCF files - a brief introduction</h3>
<p>A VCF file is a column format file where each row represents a SNP/Indel record and the columns represent things describing it like Chromosome, Position, Reference Genome Allele, Alternative Genome Allele etc. Here’s what one record looks like, split over a few lines.</p>
<table style="width:78%;">
<caption>Table continues below</caption>
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="16%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">CHROM</th>
<th align="center">POS</th>
<th align="center">ID</th>
<th align="center">REF</th>
<th align="center">ALT</th>
<th align="center">QUAL</th>
<th align="center">FILTER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">20</td>
<td align="center">14370</td>
<td align="center">rs6054257</td>
<td align="center">G</td>
<td align="center">A</td>
<td align="center">29</td>
<td align="center">PASS</td>
</tr>
</tbody>
</table>
<table>
<caption>Table continues below</caption>
<colgroup>
<col width="35%" />
<col width="18%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">INFO</th>
<th align="center">FORMAT</th>
<th align="center">NA00001</th>
<th align="center">NA00002</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">NS=3;DP=14;AF=0.5;DB;H2</td>
<td align="center">GT:GQ:DP:HQ</td>
<td align="center">0|0:48:1:51,51</td>
<td align="center">1|0:48:8:51,51</td>
</tr>
</tbody>
</table>
<table style="width:21%;">
<colgroup>
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">NA00003</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1/1:43:5:.,.</td>
</tr>
</tbody>
</table>
<p>There’s a lot of information in that one record, and each file has many tens of thousands of records! We wouldn’t want to try and process tens of thousands manually. Let’s look at loading in a file and looping through each record using the <code>PyVCF</code> package.</p>
<p>We’ve already seen that packages have functions we can call, and that doing so can sometimes return objects of new types. We’ll use that pattern now to start processing a VCF file.</p>
</div>
<div id="the-vcf.reader-object" class="section level3">
<h3><span class="header-section-number">8.2.2</span> The <code>vcf.Reader</code> object</h3>
<p>The first package function we’ll need to use is <code>vcf.Reader</code> which opens and connects to a file but doesn’t do anything with it. It gives us a reader object we can use to access the file. We just need the file name that we wish to open.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="im">import</span> vcf</a>
<a class="sourceLine" id="cb163-2" data-line-number="2">vcf_reader <span class="op">=</span> vcf.Reader(<span class="bu">open</span>(<span class="st">&#39;/Users/macleand/Desktop/example.vcf&#39;</span>, <span class="st">&#39;r&#39;</span>))</a></code></pre></div>
<p>Now we can go ahead and extract the VCF records by using the reader object we created in a loop</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb164-1" data-line-number="1"><span class="cf">for</span> record <span class="kw">in</span> vcf_reader:</a>
<a class="sourceLine" id="cb164-2" data-line-number="2">  <span class="bu">print</span>( record )</a>
<a class="sourceLine" id="cb164-3" data-line-number="3">  <span class="bu">print</span>(<span class="bu">type</span>(record))</a></code></pre></div>
<pre><code>## Record(CHROM=20, POS=14370, REF=G, ALT=[A])
## &lt;class &#39;vcf.model._Record&#39;&gt;
## Record(CHROM=20, POS=17330, REF=T, ALT=[A])
## &lt;class &#39;vcf.model._Record&#39;&gt;
## Record(CHROM=20, POS=1110696, REF=A, ALT=[G, T])
## &lt;class &#39;vcf.model._Record&#39;&gt;
## Record(CHROM=20, POS=1230237, REF=T, ALT=[None])
## &lt;class &#39;vcf.model._Record&#39;&gt;
## Record(CHROM=20, POS=1234567, REF=GTCT, ALT=[G, GTACT])
## &lt;class &#39;vcf.model._Record&#39;&gt;</code></pre>
<p>This does the code loop for every record in the file. And note how <code>print()</code> gives only a rough printout of the object, not every bit of information.</p>
</div>
<div id="the-vcf.record-object" class="section level3">
<h3><span class="header-section-number">8.2.3</span> The <code>vcf.Record</code> object</h3>
<p>Every time we loop we get a new <code>vcf.Record</code> object. This is a special sort of object provided by the <code>PyVCF</code> package that represents the VCF record. We already saw how objects have methods - special functions that apply straight to the data in that object. <code>PyVCF</code> is no exception. As well as methods, objects can have properties called attributes.</p>
</div>
<div id="object-attributes" class="section level3">
<h3><span class="header-section-number">8.2.4</span> Object Attributes</h3>
<p>As well as methods, objects have things called attributes.</p>
<p>Attributes of an object are different from methods of an object in that they tend to be things that just are rather than things that are computed. So a hypothetical <code>shape</code> object representing a geometric shape might have an attribute called <code>sides</code>. This wouldn’t need recomputing as it would be the same everytime.</p>
<p>Attributes are easy to spot as they use the <code>object</code> dot <code>.</code> syntax, omitting the brackets at the end of the attribute name. Let’s examine that using the <code>.POS</code> attribute.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb166-1" data-line-number="1">vcf_reader <span class="op">=</span> vcf.Reader(<span class="bu">open</span>(<span class="st">&#39;/Users/macleand/Desktop/example.vcf&#39;</span>, <span class="st">&#39;r&#39;</span>))</a>
<a class="sourceLine" id="cb166-2" data-line-number="2"><span class="cf">for</span> record <span class="kw">in</span> vcf_reader:</a>
<a class="sourceLine" id="cb166-3" data-line-number="3">  <span class="bu">print</span>( record.POS )</a></code></pre></div>
<pre><code>## 14370
## 17330
## 1110696
## 1230237
## 1234567</code></pre>
<p>Here we can see that we get the position of each SNP/Indel in the chromosome from <code>.POS</code>.
Note that we had to redo the vcf_reader creation - this is because the <code>vcf.Reader</code> object has in a sense “got to the end” of the data the first time we used it. It needs re-winding to the start and one way to do that is to recreate it and thereby reset it.</p>
<div id="finding-the-methods-and-attributes-an-object-has" class="section level4">
<h4><span class="header-section-number">8.2.4.1</span> Finding the methods and attributes an object has</h4>
<p>If we want to find out what methods or attributes an object has we can use the <code>dir()</code> function which gives us these for an object.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb168-1" data-line-number="1"><span class="bu">print</span>( <span class="bu">dir</span>(vcf_reader) )</a></code></pre></div>
<pre><code>## [&#39;__class__&#39;, &#39;__delattr__&#39;, &#39;__dict__&#39;, &#39;__dir__&#39;, &#39;__doc__&#39;, &#39;__eq__&#39;, &#39;__format__&#39;, &#39;__ge__&#39;, &#39;__getattribute__&#39;, &#39;__gt__&#39;, &#39;__hash__&#39;, &#39;__init__&#39;, &#39;__init_subclass__&#39;, &#39;__iter__&#39;, &#39;__le__&#39;, &#39;__lt__&#39;, &#39;__module__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;, &#39;__next__&#39;, &#39;__reduce__&#39;, &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__setattr__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;, &#39;__subclasshook__&#39;, &#39;__weakref__&#39;, &#39;_alt_pattern&#39;, &#39;_column_headers&#39;, &#39;_format_cache&#39;, &#39;_header_lines&#39;, &#39;_map&#39;, &#39;_parse_alt&#39;, &#39;_parse_info&#39;, &#39;_parse_metainfo&#39;, &#39;_parse_sample_format&#39;, &#39;_parse_samples&#39;, &#39;_prepend_chr&#39;, &#39;_reader&#39;, &#39;_row_pattern&#39;, &#39;_sample_indexes&#39;, &#39;_separator&#39;, &#39;_tabix&#39;, &#39;alts&#39;, &#39;contigs&#39;, &#39;encoding&#39;, &#39;fetch&#39;, &#39;filename&#39;, &#39;filters&#39;, &#39;formats&#39;, &#39;infos&#39;, &#39;metadata&#39;, &#39;reader&#39;, &#39;samples&#39;]</code></pre>
<p>So the list is really large! Some methods and attributes begin with <code>_</code> underscore characters. By convention these are things that are used internally by the object - so you don’t need to worry about those. We can filter the ones we can use, by building a list of ones that <em>don’t</em> start with ’_’</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb170-1" data-line-number="1">attrs <span class="op">=</span> <span class="bu">dir</span>(vcf_reader)</a>
<a class="sourceLine" id="cb170-2" data-line-number="2">keepers <span class="op">=</span> []</a>
<a class="sourceLine" id="cb170-3" data-line-number="3"><span class="cf">for</span> a <span class="kw">in</span> attrs:</a>
<a class="sourceLine" id="cb170-4" data-line-number="4">  <span class="cf">if</span> <span class="kw">not</span> a.startswith(<span class="st">&quot;_&quot;</span>):</a>
<a class="sourceLine" id="cb170-5" data-line-number="5">    keepers.append(a)</a>
<a class="sourceLine" id="cb170-6" data-line-number="6"><span class="bu">print</span>( keepers )</a></code></pre></div>
<pre><code>## [&#39;alts&#39;, &#39;contigs&#39;, &#39;encoding&#39;, &#39;fetch&#39;, &#39;filename&#39;, &#39;filters&#39;, &#39;formats&#39;, &#39;infos&#39;, &#39;metadata&#39;, &#39;reader&#39;, &#39;samples&#39;]</code></pre>
<p>This is a much shorter list. You can see the online documentation for the object here <a href="">https://pyvcf.readthedocs.io/en/latest/API.html#vcf-reader</a></p>
<p>Pretty much all objects and packages will have some online documentation so you can <em>usually</em> find something. Sometimes it’s a bit sparse, unfortunately.</p>
</div>
</div>
</div>
<div id="quiz-5" class="section level2">
<h2><span class="header-section-number">8.3</span> Quiz</h2>
<ol style="list-style-type: decimal">
<li>Using <code>PyVCF</code>, calculate how many of the records are SNPs and how many are Indels. Use the documentation to see how you might achieve this - <a href="">https://pyvcf.readthedocs.io/en/latest/API.html#vcf-model-record</a></li>
<li>For each SNP, work out whether it’s an A-G or C-T, a so-called transition. Would your method be efficient on a file of thousands of SNPS?</li>
<li>Which record has the greatest number of alleles? Would your method be efficient on a file of thousands of SNPs/Indels?</li>
<li>How many alternative alleles are heterozygous, for each record?</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="user-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="putting-code-into-scripts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["programming_with_python.pdf", "programming_with_python.epub"],
"toc": {
"collapse": "subsection"
},
"highlight": "pygments"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
